/**
 * Jailbreak detection guardrail module.
 *
 * Implements a conversation-aware jailbreak detector that leverages LLM analysis
 * to identify multi-turn escalation, manipulation, and adversarial tactics.
 * Aligns functionality with the Python guardrail by incorporating conversation history
 * and richer LLM guidance.
 */
import { z } from 'zod';
import { CheckFn, GuardrailLLMContext } from '../types';
/**
 * Configuration schema for jailbreak detection.
 */
export declare const JailbreakConfig: z.ZodObject<{
    model: z.ZodString;
    confidence_threshold: z.ZodDefault<z.ZodNumber>;
    system_prompt_details: z.ZodOptional<z.ZodString>;
}, "strip", z.ZodTypeAny, {
    model: string;
    confidence_threshold: number;
    system_prompt_details?: string | undefined;
}, {
    model: string;
    confidence_threshold?: number | undefined;
    system_prompt_details?: string | undefined;
}>;
export type JailbreakConfig = z.infer<typeof JailbreakConfig>;
/**
 * Context requirements for the jailbreak guardrail.
 */
export type JailbreakContext = GuardrailLLMContext;
/**
 * Maximum number of conversation turns to include in LLM analysis.
 *
 * Keeps payloads compact while preserving enough recent context to capture
 * multi-turn manipulation patterns (~5 user/assistant exchanges).
 */
export declare const MAX_CONTEXT_TURNS = 10;
/**
 * Extended LLM output schema including rationale.
 */
export declare const JailbreakOutput: z.ZodObject<{
    flagged: z.ZodBoolean;
    confidence: z.ZodNumber;
} & {
    /** Explanation of the guardrail decision. */
    reason: z.ZodString;
}, "strip", z.ZodTypeAny, {
    flagged: boolean;
    confidence: number;
    reason: string;
}, {
    flagged: boolean;
    confidence: number;
    reason: string;
}>;
export type JailbreakOutput = z.infer<typeof JailbreakOutput>;
/**
 * Conversation-aware jailbreak detection guardrail.
 */
export declare const jailbreak: CheckFn<JailbreakContext, string, JailbreakConfig>;
//# sourceMappingURL=jailbreak.d.ts.map